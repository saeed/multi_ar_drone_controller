<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Up and Away Testbed Complete Documentation: CoordinateController Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Up and Away Testbed Complete Documentation
   &#160;<span id="projectnumber">Version 1.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">CoordinateController Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="CoordinateController" --><!-- doxytag: inherits="CThread" -->
<p>The class that is that has the control algorithm controlling the drone (move on X axis then Y axis then rotate).  
 <a href="classCoordinateController.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CoordinateController_8h_source.html">CoordinateController.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CoordinateController:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classCoordinateController.png" usemap="#CoordinateController_map" alt=""/>
  <map id="CoordinateController_map" name="CoordinateController_map">
<area href="classCThread.html" title="Class for thread encapsualation." alt="CThread" shape="rect" coords="0,0,130,24"/>
</map>
 </div></div>

<p><a href="classCoordinateController-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#a82f887c00c3c76782e8ecbaf259dd191">CoordinateController</a> (<a class="el" href="classTargetLocator.html">TargetLocator</a> *lc, int tol, int id, char *dIP, char *dName, int port)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor handles creating the <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> instance controlled by this instance.  <a href="#a82f887c00c3c76782e8ecbaf259dd191"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#a01acae5f1cdb30a97b079469123c8c80">~CoordinateController</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The destructor.  <a href="#a01acae5f1cdb30a97b079469123c8c80"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#af208e754f5797a5775b2e7e07ac03689">goTo</a> (double x, double y, double rotateAngle)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The main control function.  <a href="#af208e754f5797a5775b2e7e07ac03689"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#aac8f1ccaf108453e4744124a459fa7d9">hover</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Hover for one second (this function is rarely used).  <a href="#aac8f1ccaf108453e4744124a459fa7d9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#add43467495f0227b68375c557f5e6c56">hover</a> (double <a class="el" href="navdataC_8h.html#ae73654f333e4363463ad8c594eca1905">time</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Hover for the set number of seconds.  <a href="#add43467495f0227b68375c557f5e6c56"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#aad6169e7545aa37c9d54e3087477ffe9">stopHovering</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Useless function [Fix Me !!].  <a href="#aad6169e7545aa37c9d54e3087477ffe9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#a828acf6f27ad55fdaa3b2e701015ce0b">run</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the control thread.  <a href="#a828acf6f27ad55fdaa3b2e701015ce0b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCoordinateController.html#a7fca74de21c639b7b9500b62ad53b732">landNow</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows external entities to set the killSwitch flag to make the drone land.  <a href="#a7fca74de21c639b7b9500b62ad53b732"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The class that is that has the control algorithm controlling the drone (move on X axis then Y axis then rotate). </p>
<p>This class has the control algorithm that controls a drone. This version of the testbed uses a very simple and light way algorithm. It moves the drone on X-axis (left or right depending on the drone's current location) till it reaches the destination's X coordinate. Then, it moves the drone on the Y-axis (forward or backwards depending the the drone's current location) till it reaches the destination's Y coordinate. This class also provides methods for Hovering and changing orientation. This class is meant to be the interface between each drone and the rest of the testbed components. Thus, this class wraps the <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> class that represents the drone. However, it's important to note that we need need a <a class="el" href="classCoordinateController.html" title="The class that is that has the control algorithm controlling the drone (move on X axis then Y axis th...">CoordinateController</a> instance for each drone. An instance of <a class="el" href="classCoordinateController.html" title="The class that is that has the control algorithm controlling the drone (move on X axis then Y axis th...">CoordinateController</a> runs a thread that continuously checks for updates in the required destination, if there is an update it moves the drone to that destination.</p>
<p>As a safety precaution, all control functions check first if the drone is seen by the master camera. If for some reason the master camera cannot see it, the killSwitch flag is set and the drone lands. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a82f887c00c3c76782e8ecbaf259dd191"></a><!-- doxytag: member="CoordinateController::CoordinateController" ref="a82f887c00c3c76782e8ecbaf259dd191" args="(TargetLocator *lc, int tol, int id, char *dIP, char *dName, int port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoordinateController.html#a82f887c00c3c76782e8ecbaf259dd191">CoordinateController::CoordinateController</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTargetLocator.html">TargetLocator</a> *&#160;</td>
          <td class="paramname"><em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The constructor handles creating the <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> instance controlled by this instance. </p>
<p>It takes the <a class="el" href="classTargetLocator.html" title="The class that uses color filters to detect the location of targets and drones (check calibrator2...">TargetLocator</a> instance to locate the drone, the drone color ID and the IP address to communicate with it. Then, uses those parameters to create a <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> instance. <b> Remember to call <a class="el" href="classCoordinateController.html#a828acf6f27ad55fdaa3b2e701015ce0b" title="Runs the control thread.">run()</a> to start the thread after creating the instance.</b> </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">lc</td><td><a class="el" href="classTargetLocator.html" title="The class that uses color filters to detect the location of targets and drones (check calibrator2...">TargetLocator</a> instance to locate the drone. </td></tr>
    <tr><td class="paramname">tol</td><td>control error in pixels (refer to <a class="el" href="heli_8cpp.html" title="The main file that has all basic configurations.">heli.cpp</a> for more information on control tolerance). </td></tr>
    <tr><td class="paramname">id</td><td>the color ID of the drone instance to query <a class="el" href="classTargetLocator.html" title="The class that uses color filters to detect the location of targets and drones (check calibrator2...">TargetLocator</a> instance. </td></tr>
    <tr><td class="paramname">dIP</td><td>drone IP to create <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> instance. </td></tr>
    <tr><td class="paramname">dName</td><td>drone name to create <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> instance. </td></tr>
    <tr><td class="paramname">port</td><td>drone designated port to create <a class="el" href="classCHeli.html" title="The class provides a basic interface to the AR-drone it envelopes the at commands, navdata and stream from ARDrone original SDK.">CHeli</a> instance. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a01acae5f1cdb30a97b079469123c8c80"></a><!-- doxytag: member="CoordinateController::~CoordinateController" ref="a01acae5f1cdb30a97b079469123c8c80" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoordinateController.html#a01acae5f1cdb30a97b079469123c8c80">CoordinateController::~CoordinateController</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The destructor. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="af208e754f5797a5775b2e7e07ac03689"></a><!-- doxytag: member="CoordinateController::goTo" ref="af208e754f5797a5775b2e7e07ac03689" args="(double x, double y, double rotateAngle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCoordinateController.html#af208e754f5797a5775b2e7e07ac03689">CoordinateController::goTo</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rotateAngle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The main control function. </p>
<p><b> Remember to call <a class="el" href="classCoordinateController.html#a828acf6f27ad55fdaa3b2e701015ce0b" title="Runs the control thread.">run()</a> to start the thread before calling this function.</b> This function updates the destination coordinates for the drone and sets moveCommandGiven flag to true. When the control thread finds that moveCommandGiven was to true, it starts moving the drone to the new destination coordinates. DO NOT call <a class="el" href="classCoordinateController.html#af208e754f5797a5775b2e7e07ac03689" title="The main control function.">goTo()</a> until the drone gets to its new destination because this code does not stop goTo from editing the destination variables with the thread is reading them. [Fix Me !!] (this is also another reason why we perform the runs in steps and the experiment human controller needs to explicitly start each step). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>new destination x coordinate (update xDestination private variable). </td></tr>
    <tr><td class="paramname">y</td><td>new destination y coordinate (update yDestination private variable). </td></tr>
    <tr><td class="paramname">rotateAngle</td><td>new destination rotateAngle coordinate (update rotationDestination private variable). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aac8f1ccaf108453e4744124a459fa7d9"></a><!-- doxytag: member="CoordinateController::hover" ref="aac8f1ccaf108453e4744124a459fa7d9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCoordinateController.html#aac8f1ccaf108453e4744124a459fa7d9">CoordinateController::hover</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hover for one second (this function is rarely used). </p>

</div>
</div>
<a class="anchor" id="add43467495f0227b68375c557f5e6c56"></a><!-- doxytag: member="CoordinateController::hover" ref="add43467495f0227b68375c557f5e6c56" args="(double time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCoordinateController.html#aac8f1ccaf108453e4744124a459fa7d9">CoordinateController::hover</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hover for the set number of seconds. </p>

</div>
</div>
<a class="anchor" id="aad6169e7545aa37c9d54e3087477ffe9"></a><!-- doxytag: member="CoordinateController::stopHovering" ref="aad6169e7545aa37c9d54e3087477ffe9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCoordinateController.html#aad6169e7545aa37c9d54e3087477ffe9">CoordinateController::stopHovering</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Useless function [Fix Me !!]. </p>

</div>
</div>
<a class="anchor" id="a828acf6f27ad55fdaa3b2e701015ce0b"></a><!-- doxytag: member="CoordinateController::run" ref="a828acf6f27ad55fdaa3b2e701015ce0b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCoordinateController.html#a828acf6f27ad55fdaa3b2e701015ce0b">CoordinateController::run</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Runs the control thread. </p>
<p>The basic idea of the control thread is simple: 1) takeoff 2) check if command given (hover if no command was given) 3) if command was given: rotate to original heading (90 degree w.r.t. master camera view), move on x axis, move on y axis, then rotate to new angle. Due to the problematic compass readings, all rotation motions should be removed for now. Till the Raspberry Pis are attached to the drones. </p>

</div>
</div>
<a class="anchor" id="a7fca74de21c639b7b9500b62ad53b732"></a><!-- doxytag: member="CoordinateController::landNow" ref="a7fca74de21c639b7b9500b62ad53b732" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCoordinateController.html#a7fca74de21c639b7b9500b62ad53b732">CoordinateController::landNow</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allows external entities to set the killSwitch flag to make the drone land. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>control/<a class="el" href="CoordinateController_8h_source.html">CoordinateController.h</a></li>
<li>control/<a class="el" href="CoordinateController_8cpp.html">CoordinateController.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 17 2014 15:34:47 for Up and Away Testbed Complete Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
